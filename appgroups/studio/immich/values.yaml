immich:
  controllers:
    main:
      containers:
        main:
          env:
            DB_HOSTNAME: immichdb-rw.cloudnative-pg.svc.cluster.local
            DB_PORT: "5432"
            DB_USERNAME: app
            DB_DATABASE_NAME: app
            DB_PASSWORD:
              valueFrom:
                secretKeyRef:
                  name: immichdb-app
                  key: password
            DB_SSLMODE: require
            DB_SSLROOTCERT: /certs/ca.crt
  immich:
    metrics:
      enabled: false
    persistence:
      library:
        existingClaim: immich-data
  # Enable Valkey (Redis)
  valkey:
    enabled: true
    master:
      persistence:
        enabled: true
        size: 1Gi

  # Your existing ingress
  server:
    ingress:
      main:
        enabled: true
        hosts:
          - host: img.studio.abode.tailandtraillabs.org
            paths:
              - path: /
        ingressClassName: studio-traefik
        annotations:
          kubernetes.io/ingress.class: studio-traefik
        tls:
          - secretName: wildcard-tls
            hosts:
              - img.studio.abode.tailandtraillabs.org